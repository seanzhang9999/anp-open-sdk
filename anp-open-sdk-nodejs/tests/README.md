# ANP Node.js SDK æµ‹è¯•æŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹

### åŸºæœ¬æµ‹è¯•å‘½ä»¤

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•ï¼ˆä½¿ç”¨æ”¹è¿›çš„æŠ¥å‘Šæ ¼å¼ï¼‰
npm test

# è¿è¡Œè¯¦ç»†æµ‹è¯•ï¼ˆæ˜¾ç¤ºæ¯ä¸ªæµ‹è¯•çš„è¯¦ç»†ä¿¡æ¯ï¼‰
npm run test:verbose

# åªè¿è¡Œå¤±è´¥çš„æµ‹è¯•
npm run test:failed

# è¿è¡Œè·¨è¯­è¨€å…¼å®¹æ€§æµ‹è¯•
npm run test:cross-lang

# è¿è¡ŒåŸºç¡€åŠŸèƒ½æµ‹è¯•
npm run test:foundation

# ç®€æ´æ¨¡å¼ï¼ˆåªæ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯ï¼‰
npm run test:summary
```

### é’ˆå¯¹ç‰¹å®šæµ‹è¯•çš„å‘½ä»¤

```bash
# è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
npm test tests/foundation/local-user-data.test.ts

# è¿è¡ŒåŒ…å«ç‰¹å®šæ¨¡å¼çš„æµ‹è¯•
npm test -- --testNamePattern="should create user"

# è¿è¡Œç‰¹å®šæµ‹è¯•å¥—ä»¶
npm test -- --testPathPattern="python-server-compatibility"

# ç›‘è§†æ¨¡å¼ï¼ˆæ–‡ä»¶å˜åŒ–æ—¶è‡ªåŠ¨é‡æ–°è¿è¡Œï¼‰
npm run test:watch
```

## ğŸ“Š æ”¹è¿›çš„æµ‹è¯•æŠ¥å‘Š

### æ–°çš„æŠ¥å‘Šæ ¼å¼ç‰¹æ€§

1. **æ¸…æ™°çš„ç»Ÿè®¡ä¿¡æ¯**
   - æ€»æµ‹è¯•æ•°ã€é€šè¿‡æ•°ã€å¤±è´¥æ•°
   - æˆåŠŸç‡ç™¾åˆ†æ¯”
   - æ‰§è¡Œæ—¶é—´ç»Ÿè®¡

2. **æŒ‰æµ‹è¯•å¥—ä»¶åˆ†ç»„**
   - æ¯ä¸ªæµ‹è¯•æ–‡ä»¶çš„é€šè¿‡/å¤±è´¥çŠ¶æ€
   - å¤±è´¥æµ‹è¯•çš„å…·ä½“åç§°å’Œé”™è¯¯ä¿¡æ¯

3. **è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯**
   - æ¸…ç†åçš„é”™è¯¯æ¶ˆæ¯
   - æ–‡ä»¶ä½ç½®å’Œè¡Œå·
   - å…·ä½“çš„å¤±è´¥åŸå› 

4. **æ€§èƒ½ç»Ÿè®¡**
   - æ€»æ‰§è¡Œæ—¶é—´
   - æ…¢é€Ÿæµ‹è¯•è¯†åˆ«ï¼ˆ>1ç§’ï¼‰
   - æ€§èƒ½å»ºè®®

5. **æ™ºèƒ½å»ºè®®**
   - åŸºäºæµ‹è¯•ç»“æœçš„ä¿®å¤å»ºè®®
   - è°ƒè¯•å‘½ä»¤æç¤º

### ç¤ºä¾‹è¾“å‡º

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ§ª ANP Node.js SDK æµ‹è¯•ç»“æœè¯¦ç»†æŠ¥å‘Š
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š æµ‹è¯•ç»Ÿè®¡:
   â€¢ æ€»æµ‹è¯•æ•°: 239
   â€¢ é€šè¿‡: 205 âœ…
   â€¢ å¤±è´¥: 34 âŒ
   â€¢ æˆåŠŸç‡: 85.8%

ğŸ“‹ æµ‹è¯•å¥—ä»¶è¯¦æƒ…:

âœ… local-user-data.test (15/15)
âŒ python-server-compatibility.test (12/16)
   å¤±è´¥çš„æµ‹è¯•:
   âŒ should handle authentication failures
      ğŸ’¥ Expected: false, Received: true

ğŸ” å¤±è´¥æµ‹è¯•è¯¦ç»†ä¿¡æ¯:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âŒ è®¤è¯å…¼å®¹æ€§æµ‹è¯• > should handle authentication failures
   æ–‡ä»¶: ./tests/cross-language/python-server-compatibility.test.ts
   é”™è¯¯ 1:
   Expected: false
   Received: true
   
   at Object.<anonymous> (tests/cross-language/python-server-compatibility.test.ts:475:32)

âš¡ æ€§èƒ½ç»Ÿè®¡:
   â€¢ æ€»æ‰§è¡Œæ—¶é—´: 8.97ç§’
   â€¢ æ…¢é€Ÿæµ‹è¯• (>1ç§’):
     - should handle concurrent requests: 2340ms

ğŸ¯ æµ‹è¯•æ€»ç»“:
   âš ï¸  å‘ç° 34 ä¸ªå¤±è´¥æµ‹è¯•ï¼Œéœ€è¦ä¿®å¤ã€‚
   ğŸ’¡ å»ºè®®:
      1. æ£€æŸ¥ä¸Šè¿°å¤±è´¥æµ‹è¯•çš„é”™è¯¯ä¿¡æ¯
      2. ç¡®è®¤æµ‹è¯•ç¯å¢ƒå’Œä¾èµ–æ˜¯å¦æ­£ç¡®
      3. è¿è¡Œå•ä¸ªæµ‹è¯•è¿›è¡Œè°ƒè¯•: npm test -- --testNamePattern="æµ‹è¯•åç§°"
```

## ğŸ”§ è°ƒè¯•å¤±è´¥çš„æµ‹è¯•

### æ­¥éª¤1: è¯†åˆ«å¤±è´¥çš„æµ‹è¯•
è¿è¡Œ `npm run test:verbose` æŸ¥çœ‹è¯¦ç»†çš„å¤±è´¥ä¿¡æ¯ã€‚

### æ­¥éª¤2: è¿è¡Œå•ä¸ªæµ‹è¯•
```bash
# è¿è¡Œç‰¹å®šçš„å¤±è´¥æµ‹è¯•
npm test -- --testNamePattern="should handle authentication failures"

# æˆ–è¿è¡Œæ•´ä¸ªæµ‹è¯•æ–‡ä»¶
npm test tests/cross-language/python-server-compatibility.test.ts
```

### æ­¥éª¤3: å¯ç”¨è°ƒè¯•æ¨¡å¼
```bash
# å¯ç”¨è¯¦ç»†æ—¥å¿—
DEBUG=* npm test -- --testNamePattern="æµ‹è¯•åç§°"

# æˆ–ä½¿ç”¨Node.jsè°ƒè¯•å™¨
node --inspect-brk node_modules/.bin/jest --runInBand --testNamePattern="æµ‹è¯•åç§°"
```

## ğŸ“ˆ æµ‹è¯•æœ€ä½³å®è·µ

### 1. è¿è¡Œæµ‹è¯•å‰çš„æ£€æŸ¥æ¸…å•
- [ ] ç¡®ä¿PythonæœåŠ¡å™¨è¿è¡Œï¼ˆè·¨è¯­è¨€æµ‹è¯•éœ€è¦ï¼‰
- [ ] æ£€æŸ¥æµ‹è¯•æ•°æ®æ˜¯å¦å­˜åœ¨
- [ ] ç¡®è®¤ç¯å¢ƒå˜é‡é…ç½®æ­£ç¡®

### 2. è§£è¯»æµ‹è¯•ç»“æœ
- âœ… **ç»¿è‰²é€šè¿‡**: åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- âŒ **çº¢è‰²å¤±è´¥**: éœ€è¦ä¿®å¤çš„é—®é¢˜
- â­ï¸ **è·³è¿‡æµ‹è¯•**: é€šå¸¸å› ä¸ºä¾èµ–æ¡ä»¶ä¸æ»¡è¶³

### 3. å¸¸è§å¤±è´¥åŸå› 
1. **PythonæœåŠ¡å™¨æœªè¿è¡Œ**: è·¨è¯­è¨€æµ‹è¯•ä¼šå¤±è´¥
2. **ç”¨æˆ·æ•°æ®ç¼ºå¤±**: æ£€æŸ¥ `data_user/` ç›®å½•
3. **ç½‘ç»œé—®é¢˜**: æ£€æŸ¥localhostè¿æ¥
4. **ç¯å¢ƒé…ç½®**: ç¡®è®¤Node.jsç‰ˆæœ¬å’Œä¾èµ–

## ğŸ¯ ç‰¹å®šæµ‹è¯•åœºæ™¯

### è·¨è¯­è¨€å…¼å®¹æ€§æµ‹è¯•
```bash
# 1. å¯åŠ¨PythonæœåŠ¡å™¨
PYTHONPATH=$PYTHONPATH:/path/to/anp-open-sdk-python python examples/flow_anp_agent/flow_anp_agent.py

# 2. è¿è¡Œè·¨è¯­è¨€æµ‹è¯•
npm run test:cross-lang
```

### åŸºç¡€åŠŸèƒ½æµ‹è¯•
```bash
# è¿è¡ŒåŸºç¡€åŠŸèƒ½æµ‹è¯•ï¼ˆä¸éœ€è¦PythonæœåŠ¡å™¨ï¼‰
npm run test:foundation
```

### æŒç»­é›†æˆæµ‹è¯•
```bash
# CIç¯å¢ƒä¸­çš„æµ‹è¯•å‘½ä»¤
npm run test:summary
```

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

1. **æ‰€æœ‰æµ‹è¯•éƒ½è¢«è·³è¿‡**
   - æ£€æŸ¥PythonæœåŠ¡å™¨æ˜¯å¦è¿è¡Œ
   - ç¡®è®¤ç«¯å£9527æ˜¯å¦å¯ç”¨

2. **è®¤è¯ç›¸å…³æµ‹è¯•å¤±è´¥**
   - æ£€æŸ¥ç”¨æˆ·DIDæ•°æ®æ˜¯å¦å­˜åœ¨
   - ç¡®è®¤ç§é’¥æ–‡ä»¶æ˜¯å¦æ­£ç¡®

3. **æ€§èƒ½æµ‹è¯•è¶…æ—¶**
   - æ£€æŸ¥ç½‘ç»œè¿æ¥
   - è€ƒè™‘å¢åŠ æµ‹è¯•è¶…æ—¶æ—¶é—´

4. **æŠ¥å‘Šå™¨é”™è¯¯**
   - ç¡®è®¤ `tests/custom-reporter.js` æ–‡ä»¶å­˜åœ¨
   - æ£€æŸ¥Jesté…ç½®æ˜¯å¦æ­£ç¡®

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Jestå®˜æ–¹æ–‡æ¡£](https://jestjs.io/docs/getting-started)
- [è·¨è¯­è¨€å…¼å®¹æ€§æµ‹è¯•è¯¦æƒ…](./cross-language/README.md)
- [ANP Node.js SDKæ–‡æ¡£](../README.md)

## ğŸ¤ è´¡çŒ®æŒ‡å—

å¦‚æœæ‚¨å‘ç°æµ‹è¯•é—®é¢˜æˆ–æƒ³è¦æ”¹è¿›æµ‹è¯•æŠ¥å‘Šï¼Œè¯·ï¼š

1. åˆ›å»ºIssueæè¿°é—®é¢˜
2. æäº¤Pull Request withæ”¹è¿›
3. ç¡®ä¿æ–°æµ‹è¯•éµå¾ªç°æœ‰æ¨¡å¼
4. æ›´æ–°ç›¸å…³æ–‡æ¡£

---

**æç¤º**: ä½¿ç”¨ `npm run test:verbose` è·å¾—æœ€è¯¦ç»†çš„æµ‹è¯•ä¿¡æ¯ï¼Œè¿™æ˜¯è°ƒè¯•é—®é¢˜çš„æœ€ä½³èµ·ç‚¹ã€‚