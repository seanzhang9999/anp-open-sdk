{
  "summary": {
    "total_config_usages": 80,
    "files_with_config": 15,
    "unique_config_keys": 29,
    "analysis_timestamp": "/Users/seanzhang/seanrework/anp-open-sdk"
  },
  "detailed_usages": [
    {
      "file": "anp_runtime/agent_manager.py",
      "line": 583,
      "type": "config_access",
      "config_key": "get",
      "code": "path_mappings = config.get('path_mappings', {})",
      "context": [
        "            return None, None",
        "",
        "        config = self.shared_did_registry[shared_did]",
        "        path_mappings = config.get('path_mappings', {})",
        "",
        "        # ç²¾ç¡®åŒ¹é…",
        "        if api_path in path_mappings:"
      ],
      "function": "_resolve_shared_did",
      "class": "AgentRouter"
    },
    {
      "file": "anp_runtime/agent_manager.py",
      "line": 847,
      "type": "config_access",
      "config_key": "get",
      "code": "if share_config.get('enabled'):",
      "context": [
        "        # æ£€æŸ¥å…±äº«DIDé…ç½®",
        "        share_did_config = None",
        "        share_config = cfg.get('share_did', {})",
        "        if share_config.get('enabled'):",
        "            share_did_config = {",
        "                'shared_did': share_config['shared_did'],",
        "                'path_prefix': share_config.get('path_prefix', ''),"
      ],
      "function": "load_agent_from_module",
      "class": "LocalAgentManager"
    },
    {
      "file": "anp_runtime/agent_manager.py",
      "line": 850,
      "type": "config_access",
      "config_key": "get",
      "code": "'path_prefix': share_config.get('path_prefix', ''),",
      "context": [
        "        if share_config.get('enabled'):",
        "            share_did_config = {",
        "                'shared_did': share_config['shared_did'],",
        "                'path_prefix': share_config.get('path_prefix', ''),",
        "                'primary_agent': share_config.get('primary_agent', False),  # é»˜è®¤ä¸ºå‰¯Agent",
        "                'api_paths': [api['path'] for api in cfg.get('api', [])]",
        "            }"
      ],
      "function": "load_agent_from_module",
      "class": "LocalAgentManager"
    },
    {
      "file": "anp_runtime/agent_manager.py",
      "line": 851,
      "type": "config_access",
      "config_key": "get",
      "code": "'primary_agent': share_config.get('primary_agent', False),  # é»˜è®¤ä¸ºå‰¯Agent",
      "context": [
        "            share_did_config = {",
        "                'shared_did': share_config['shared_did'],",
        "                'path_prefix': share_config.get('path_prefix', ''),",
        "                'primary_agent': share_config.get('primary_agent', False),  # é»˜è®¤ä¸ºå‰¯Agent",
        "                'api_paths': [api['path'] for api in cfg.get('api', [])]",
        "            }",
        "            logger.debug(f\"  -> æ£€æµ‹åˆ°å…±äº«DIDé…ç½®: {share_did_config}\")"
      ],
      "function": "load_agent_from_module",
      "class": "LocalAgentManager"
    },
    {
      "file": "anp_runtime/agent_manager.py",
      "line": 874,
      "type": "config_access",
      "config_key": "get",
      "code": "if not share_did_config.get('path_prefix'):",
      "context": [
        "        # åˆ›å»ºæ–°çš„Agentå®ä¾‹ - å…¨é¢ä½¿ç”¨æ–°Agentç³»ç»Ÿ",
        "        if share_did_config:",
        "            # ç¡®ä¿å…±äº«DIDé…ç½®å®Œæ•´",
        "            if not share_did_config.get('path_prefix'):",
        "                raise ValueError(f\"âŒ å…±äº«DIDé…ç½®ç¼ºå°‘ path_prefix: {base_module_name}\")",
        "",
        "            anp_agent = AgentManager.create_agent("
      ],
      "function": "load_agent_from_module",
      "class": "LocalAgentManager"
    },
    {
      "file": "anp_runtime/agent_manager.py",
      "line": 880,
      "type": "config_access",
      "config_key": "get",
      "code": "prefix=share_did_config.get('path_prefix', ''),",
      "context": [
        "            anp_agent = AgentManager.create_agent(",
        "                anp_user_did,  cfg['name'],",
        "                shared=True,",
        "                prefix=share_did_config.get('path_prefix', ''),",
        "                primary_agent=share_did_config.get('primary_agent', False)",
        "            )",
        "        else:"
      ],
      "function": "load_agent_from_module",
      "class": "LocalAgentManager"
    },
    {
      "file": "anp_runtime/agent_manager.py",
      "line": 881,
      "type": "config_access",
      "config_key": "get",
      "code": "primary_agent=share_did_config.get('primary_agent', False)",
      "context": [
        "                anp_user_did,  cfg['name'],",
        "                shared=True,",
        "                prefix=share_did_config.get('path_prefix', ''),",
        "                primary_agent=share_did_config.get('primary_agent', False)",
        "            )",
        "        else:",
        "            anp_agent = AgentManager.create_agent(anp_user_did, cfg['name'], shared=False)"
      ],
      "function": "load_agent_from_module",
      "class": "LocalAgentManager"
    },
    {
      "file": "anp_runtime/agent_manager.py",
      "line": 937,
      "type": "config_access",
      "config_key": "get",
      "code": "is_primary = share_did_config.get('primary_agent', False)",
      "context": [
        "        # æ£€æŸ¥æ˜¯å¦æ˜¯å…±äº«DIDæ¨¡å¼ä½†ä¸æ˜¯ä¸»Agent",
        "        is_shared_non_primary = False",
        "        if share_did_config:  # åªæ£€æŸ¥share_did_configæ˜¯å¦å­˜åœ¨",
        "            is_primary = share_did_config.get('primary_agent', False)",
        "            if not is_primary:",
        "                is_shared_non_primary = True",
        "                logger.info(f\"â„¹ï¸ æ³¨æ„: {cfg.get('name')} æ˜¯å…±äº«DIDçš„éä¸»Agentï¼Œå°†è·³è¿‡æ¶ˆæ¯å¤„ç†å™¨æ³¨å†Œ (è¿™æ˜¯é¢„æœŸè¡Œä¸º)\")"
      ],
      "function": "_register_message_handlers_new",
      "class": "LocalAgentManager"
    },
    {
      "file": "anp_server/run_lite_server_template.py",
      "line": 61,
      "type": "get_global_config",
      "code": "config = get_global_config()",
      "context": [
        "",
        "        self.logger = logger",
        "        self.initialized = True",
        "        config = get_global_config()",
        "        self.debug_mode = config.anp_sdk.debug_mode",
        "        if self.debug_mode:",
        "            self.app = FastAPI("
      ],
      "function": "__init__",
      "class": "ANP_Server"
    },
    {
      "file": "anp_server/run_lite_server_template.py",
      "line": 117,
      "type": "get_global_config",
      "code": "config = get_global_config()",
      "context": [
        "        from anp_foundation.config import get_global_config",
        "",
        "        # 2. ä¿®æ­£é…ç½®é¡¹çš„åç§°",
        "        config = get_global_config()",
        "        port = config.anp_sdk.port",
        "        host = config.anp_sdk.host",
        ""
      ],
      "function": "start_server",
      "class": "ANP_Server"
    },
    {
      "file": "anp_server/run_lite_server_template.py",
      "line": 62,
      "type": "config_access",
      "config_key": "anp_sdk.debug_mode",
      "code": "self.debug_mode = config.anp_sdk.debug_mode",
      "context": [
        "        self.logger = logger",
        "        self.initialized = True",
        "        config = get_global_config()",
        "        self.debug_mode = config.anp_sdk.debug_mode",
        "        if self.debug_mode:",
        "            self.app = FastAPI(",
        "                title=\"ANP DID Server in DebugMode\","
      ],
      "function": "__init__",
      "class": "ANP_Server"
    },
    {
      "file": "anp_server/run_lite_server_template.py",
      "line": 118,
      "type": "config_access",
      "config_key": "anp_sdk.port",
      "code": "port = config.anp_sdk.port",
      "context": [
        "",
        "        # 2. ä¿®æ­£é…ç½®é¡¹çš„åç§°",
        "        config = get_global_config()",
        "        port = config.anp_sdk.port",
        "        host = config.anp_sdk.host",
        "",
        "        app_instance = self.app"
      ],
      "function": "start_server",
      "class": "ANP_Server"
    },
    {
      "file": "anp_server/run_lite_server_template.py",
      "line": 119,
      "type": "config_access",
      "config_key": "anp_sdk.host",
      "code": "host = config.anp_sdk.host",
      "context": [
        "        # 2. ä¿®æ­£é…ç½®é¡¹çš„åç§°",
        "        config = get_global_config()",
        "        port = config.anp_sdk.port",
        "        host = config.anp_sdk.host",
        "",
        "        app_instance = self.app",
        ""
      ],
      "function": "start_server",
      "class": "ANP_Server"
    },
    {
      "file": "anp_server/baseline/anp_server_baseline.py",
      "line": 56,
      "type": "get_global_config",
      "code": "config = get_global_config()",
      "context": [
        "",
        "        self.logger = logger",
        "        self.initialized = True",
        "        config = get_global_config()",
        "        self.debug_mode = config.anp_sdk.debug_mode",
        "",
        ""
      ],
      "function": "__init__",
      "class": "ANP_Server"
    },
    {
      "file": "anp_server/baseline/anp_server_baseline.py",
      "line": 116,
      "type": "get_global_config",
      "code": "config = get_global_config()",
      "context": [
        "        from anp_foundation.config import get_global_config",
        "",
        "        # 2. ä¿®æ­£é…ç½®é¡¹çš„åç§°",
        "        config = get_global_config()",
        "",
        "        port = config.anp_sdk.port",
        "        host = config.anp_sdk.host"
      ],
      "function": "start_server",
      "class": "ANP_Server"
    },
    {
      "file": "anp_server/baseline/anp_server_baseline.py",
      "line": 57,
      "type": "config_access",
      "config_key": "anp_sdk.debug_mode",
      "code": "self.debug_mode = config.anp_sdk.debug_mode",
      "context": [
        "        self.logger = logger",
        "        self.initialized = True",
        "        config = get_global_config()",
        "        self.debug_mode = config.anp_sdk.debug_mode",
        "",
        "",
        "        if self.debug_mode:"
      ],
      "function": "__init__",
      "class": "ANP_Server"
    },
    {
      "file": "anp_server/baseline/anp_server_baseline.py",
      "line": 118,
      "type": "config_access",
      "config_key": "anp_sdk.port",
      "code": "port = config.anp_sdk.port",
      "context": [
        "        # 2. ä¿®æ­£é…ç½®é¡¹çš„åç§°",
        "        config = get_global_config()",
        "",
        "        port = config.anp_sdk.port",
        "        host = config.anp_sdk.host",
        "",
        "        app_instance = self.app"
      ],
      "function": "start_server",
      "class": "ANP_Server"
    },
    {
      "file": "anp_server/baseline/anp_server_baseline.py",
      "line": 119,
      "type": "config_access",
      "config_key": "anp_sdk.host",
      "code": "host = config.anp_sdk.host",
      "context": [
        "        config = get_global_config()",
        "",
        "        port = config.anp_sdk.port",
        "        host = config.anp_sdk.host",
        "",
        "        app_instance = self.app",
        ""
      ],
      "function": "start_server",
      "class": "ANP_Server"
    },
    {
      "file": "anp_servicepoint/auth_exempt_handler.py",
      "line": 5,
      "type": "get_global_config",
      "code": "config = get_global_config()",
      "context": [
        "",
        "from anp_foundation.config import get_global_config",
        "",
        "config = get_global_config()",
        "EXEMPT_PATHS = config.auth_middleware.exempt_paths",
        "",
        ""
      ],
      "function": "unknown",
      "class": "unknown"
    },
    {
      "file": "anp_servicepoint/auth_exempt_handler.py",
      "line": 6,
      "type": "config_access",
      "config_key": "auth_middleware.exempt_paths",
      "code": "EXEMPT_PATHS = config.auth_middleware.exempt_paths",
      "context": [
        "from anp_foundation.config import get_global_config",
        "",
        "config = get_global_config()",
        "EXEMPT_PATHS = config.auth_middleware.exempt_paths",
        "",
        "",
        "def is_exempt(path):"
      ],
      "function": "unknown",
      "class": "unknown"
    },
    {
      "file": "anp_servicepoint/extend_service_implementation/did_host/did_host_manager.py",
      "line": 35,
      "type": "get_global_config",
      "code": "config = get_global_config()",
      "context": [
        "            self.hostport = str(port)",
        "        else:",
        "            # å…¼å®¹æ¨¡å¼ï¼šä½¿ç”¨ç°æœ‰é€»è¾‘",
        "            config = get_global_config()",
        "            self.hosted_dir = Path(hosted_dir or config.anp_sdk.user_hosted_path)",
        "            self.hostdomain = os.environ.get('HOST_DID_DOMAIN', 'localhost')",
        "            self.hostport = os.environ.get('HOST_DID_PORT', '9527')"
      ],
      "function": "__init__",
      "class": "DIDHostManager"
    },
    {
      "file": "anp_servicepoint/extend_service_implementation/did_host/did_host_manager.py",
      "line": 36,
      "type": "config_access",
      "config_key": "anp_sdk.user_hosted_path",
      "code": "self.hosted_dir = Path(hosted_dir or config.anp_sdk.user_hosted_path)",
      "context": [
        "        else:",
        "            # å…¼å®¹æ¨¡å¼ï¼šä½¿ç”¨ç°æœ‰é€»è¾‘",
        "            config = get_global_config()",
        "            self.hosted_dir = Path(hosted_dir or config.anp_sdk.user_hosted_path)",
        "            self.hostdomain = os.environ.get('HOST_DID_DOMAIN', 'localhost')",
        "            self.hostport = os.environ.get('HOST_DID_PORT', '9527')",
        "            "
      ],
      "function": "__init__",
      "class": "DIDHostManager"
    },
    {
      "file": "anp_servicepoint/core_service_handler/agent_service_handler.py",
      "line": 32,
      "type": "get_global_config",
      "code": "config = get_global_config()",
      "context": [
        "        Dict[str, Any]: å¤„ç†ç»“æœ",
        "    \"\"\"",
        "    # è·å–é…ç½®",
        "    config = get_global_config()",
        "    use_transformer_server = getattr(config.anp_sdk, \"use_transformer_server\", False)",
        "    transformer_server_url = getattr(config.anp_sdk, \"transformer_server_url\", \"http://localhost:9528\")",
        ""
      ],
      "function": "process_group_request",
      "class": "unknown"
    },
    {
      "file": "anp_servicepoint/core_service_handler/agent_service_handler.py",
      "line": 100,
      "type": "get_global_config",
      "code": "config = get_global_config()",
      "context": [
        "        Dict[str, Any]: å¤„ç†ç»“æœ",
        "    \"\"\"",
        "    # è·å–é…ç½®",
        "    config = get_global_config()",
        "    use_transformer_server = getattr(config.anp_sdk, \"use_transformer_server\", False)",
        "    transformer_server_url = getattr(config.anp_sdk, \"transformer_server_url\", \"http://localhost:9528\")",
        ""
      ],
      "function": "process_agent_api_request",
      "class": "unknown"
    },
    {
      "file": "anp_servicepoint/core_service_handler/agent_service_handler.py",
      "line": 200,
      "type": "get_global_config",
      "code": "config = get_global_config()",
      "context": [
        "        Dict[str, Any]: å¤„ç†ç»“æœ",
        "    \"\"\"",
        "    # è·å–é…ç½®",
        "    config = get_global_config()",
        "    use_transformer_server = getattr(config.anp_sdk, \"use_transformer_server\", False)",
        "    transformer_server_url = getattr(config.anp_sdk, \"transformer_server_url\", \"http://localhost:9528\")",
        ""
      ],
      "function": "process_agent_message",
      "class": "unknown"
    },
    {
      "file": "anp_servicepoint/core_service_handler/agent_service_handler.py",
      "line": 33,
      "type": "config_access",
      "config_key": "anp_sdk",
      "code": "use_transformer_server = getattr(config.anp_sdk, \"use_transformer_server\", False)",
      "context": [
        "    \"\"\"",
        "    # è·å–é…ç½®",
        "    config = get_global_config()",
        "    use_transformer_server = getattr(config.anp_sdk, \"use_transformer_server\", False)",
        "    transformer_server_url = getattr(config.anp_sdk, \"transformer_server_url\", \"http://localhost:9528\")",
        "",
        "    # æ ¹æ®é…ç½®å†³å®šå¤„ç†æ–¹å¼"
      ],
      "function": "process_group_request",
      "class": "unknown"
    },
    {
      "file": "anp_servicepoint/core_service_handler/agent_service_handler.py",
      "line": 34,
      "type": "config_access",
      "config_key": "anp_sdk",
      "code": "transformer_server_url = getattr(config.anp_sdk, \"transformer_server_url\", \"http://localhost:9528\")",
      "context": [
        "    # è·å–é…ç½®",
        "    config = get_global_config()",
        "    use_transformer_server = getattr(config.anp_sdk, \"use_transformer_server\", False)",
        "    transformer_server_url = getattr(config.anp_sdk, \"transformer_server_url\", \"http://localhost:9528\")",
        "",
        "    # æ ¹æ®é…ç½®å†³å®šå¤„ç†æ–¹å¼",
        "    if use_transformer_server:"
      ],
      "function": "process_group_request",
      "class": "unknown"
    },
    {
      "file": "anp_servicepoint/core_service_handler/agent_service_handler.py",
      "line": 67,
      "type": "config_access",
      "config_key": "anp_sdk",
      "code": "if not getattr(config.anp_sdk, \"fallback_to_local\", True):",
      "context": [
        "                    else:",
        "                        error_text = await response.text()",
        "                        logger.error(f\"âŒ Framework serverè¿”å›é”™è¯¯: {response.status} - {error_text}\")",
        "                        if not getattr(config.anp_sdk, \"fallback_to_local\", True):",
        "                            return {\"status\": \"error\", \"message\": f\"Framework serveré”™è¯¯: {response.status}\"}",
        "        except Exception as e:",
        "            logger.error(f\"âŒ è½¬å‘åˆ°Framework serverå¤±è´¥: {e}\")"
      ],
      "function": "process_group_request",
      "class": "unknown"
    },
    {
      "file": "anp_servicepoint/core_service_handler/agent_service_handler.py",
      "line": 71,
      "type": "config_access",
      "config_key": "anp_sdk",
      "code": "if not getattr(config.anp_sdk, \"fallback_to_local\", True):",
      "context": [
        "                            return {\"status\": \"error\", \"message\": f\"Framework serveré”™è¯¯: {response.status}\"}",
        "        except Exception as e:",
        "            logger.error(f\"âŒ è½¬å‘åˆ°Framework serverå¤±è´¥: {e}\")",
        "            if not getattr(config.anp_sdk, \"fallback_to_local\", True):",
        "                return {\"status\": \"error\", \"message\": f\"Framework serverè¿æ¥å¤±è´¥: {str(e)}\"}",
        "",
        "    # æœ¬åœ°å¤„ç†"
      ],
      "function": "process_group_request",
      "class": "unknown"
    },
    {
      "file": "anp_servicepoint/core_service_handler/agent_service_handler.py",
      "line": 101,
      "type": "config_access",
      "config_key": "anp_sdk",
      "code": "use_transformer_server = getattr(config.anp_sdk, \"use_transformer_server\", False)",
      "context": [
        "    \"\"\"",
        "    # è·å–é…ç½®",
        "    config = get_global_config()",
        "    use_transformer_server = getattr(config.anp_sdk, \"use_transformer_server\", False)",
        "    transformer_server_url = getattr(config.anp_sdk, \"transformer_server_url\", \"http://localhost:9528\")",
        "",
        "    # æ„é€ è¯·æ±‚æ•°æ®"
      ],
      "function": "process_agent_api_request",
      "class": "unknown"
    },
    {
      "file": "anp_servicepoint/core_service_handler/agent_service_handler.py",
      "line": 102,
      "type": "config_access",
      "config_key": "anp_sdk",
      "code": "transformer_server_url = getattr(config.anp_sdk, \"transformer_server_url\", \"http://localhost:9528\")",
      "context": [
        "    # è·å–é…ç½®",
        "    config = get_global_config()",
        "    use_transformer_server = getattr(config.anp_sdk, \"use_transformer_server\", False)",
        "    transformer_server_url = getattr(config.anp_sdk, \"transformer_server_url\", \"http://localhost:9528\")",
        "",
        "    # æ„é€ è¯·æ±‚æ•°æ®",
        "    processed_data = {"
      ],
      "function": "process_agent_api_request",
      "class": "unknown"
    },
    {
      "file": "anp_servicepoint/core_service_handler/agent_service_handler.py",
      "line": 151,
      "type": "config_access",
      "config_key": "anp_sdk",
      "code": "if not getattr(config.anp_sdk, \"fallback_to_local\", True):",
      "context": [
        "                        error_text = await response.text()",
        "                        logger.error(f\"âŒ transformer serverè¿”å›é”™è¯¯: {response.status} - {error_text}\")",
        "                        # å¤±è´¥æ—¶å›é€€åˆ°æœ¬åœ°å¤„ç†",
        "                        if not getattr(config.anp_sdk, \"fallback_to_local\", True):",
        "                            return {\"status\": \"error\", \"message\": f\"transformer serveré”™è¯¯: {response.status}\",",
        "                                    \"details\": error_text}",
        "        except Exception as e:"
      ],
      "function": "process_agent_api_request",
      "class": "unknown"
    },
    {
      "file": "anp_servicepoint/core_service_handler/agent_service_handler.py",
      "line": 157,
      "type": "config_access",
      "config_key": "anp_sdk",
      "code": "if not getattr(config.anp_sdk, \"fallback_to_local\", True):",
      "context": [
        "        except Exception as e:",
        "            logger.error(f\"âŒ transformer serverå¤±è´¥: {e}\")",
        "            # å¤±è´¥æ—¶å›é€€åˆ°æœ¬åœ°å¤„ç†",
        "            if not getattr(config.anp_sdk, \"fallback_to_local\", True):",
        "                return {\"status\": \"error\", \"message\": f\"transformer serverè¿æ¥å¤±è´¥: {str(e)}\"}",
        "            logger.debug(\"âš ï¸ å›é€€åˆ°æœ¬åœ°å¤„ç†\")",
        ""
      ],
      "function": "process_agent_api_request",
      "class": "unknown"
    },
    {
      "file": "anp_servicepoint/core_service_handler/agent_service_handler.py",
      "line": 201,
      "type": "config_access",
      "config_key": "anp_sdk",
      "code": "use_transformer_server = getattr(config.anp_sdk, \"use_transformer_server\", False)",
      "context": [
        "    \"\"\"",
        "    # è·å–é…ç½®",
        "    config = get_global_config()",
        "    use_transformer_server = getattr(config.anp_sdk, \"use_transformer_server\", False)",
        "    transformer_server_url = getattr(config.anp_sdk, \"transformer_server_url\", \"http://localhost:9528\")",
        "",
        "    # æ„é€ è¯·æ±‚æ•°æ®"
      ],
      "function": "process_agent_message",
      "class": "unknown"
    },
    {
      "file": "anp_servicepoint/core_service_handler/agent_service_handler.py",
      "line": 202,
      "type": "config_access",
      "config_key": "anp_sdk",
      "code": "transformer_server_url = getattr(config.anp_sdk, \"transformer_server_url\", \"http://localhost:9528\")",
      "context": [
        "    # è·å–é…ç½®",
        "    config = get_global_config()",
        "    use_transformer_server = getattr(config.anp_sdk, \"use_transformer_server\", False)",
        "    transformer_server_url = getattr(config.anp_sdk, \"transformer_server_url\", \"http://localhost:9528\")",
        "",
        "    # æ„é€ è¯·æ±‚æ•°æ®",
        "    processed_data = {"
      ],
      "function": "process_agent_message",
      "class": "unknown"
    },
    {
      "file": "anp_servicepoint/core_service_handler/agent_service_handler.py",
      "line": 250,
      "type": "config_access",
      "config_key": "anp_sdk",
      "code": "if not getattr(config.anp_sdk, \"fallback_to_local\", True):",
      "context": [
        "                        error_text = await response.text()",
        "                        logger.error(f\"âŒ transformer serverè¿”å›é”™è¯¯: {response.status} - {error_text}\")",
        "                        # å¤±è´¥æ—¶å›é€€åˆ°æœ¬åœ°å¤„ç†",
        "                        if not getattr(config.anp_sdk, \"fallback_to_local\", True):",
        "                            return {\"anp_result\": {\"status\": \"error\",",
        "                                                   \"message\": f\"transformer serveré”™è¯¯: {response.status}\"}}",
        "        except Exception as e:"
      ],
      "function": "process_agent_message",
      "class": "unknown"
    },
    {
      "file": "anp_servicepoint/core_service_handler/agent_service_handler.py",
      "line": 256,
      "type": "config_access",
      "config_key": "anp_sdk",
      "code": "if not getattr(config.anp_sdk, \"fallback_to_local\", True):",
      "context": [
        "        except Exception as e:",
        "            logger.error(f\"âŒ transformer serverå¤±è´¥: {e}\")",
        "            # å¤±è´¥æ—¶å›é€€åˆ°æœ¬åœ°å¤„ç†",
        "            if not getattr(config.anp_sdk, \"fallback_to_local\", True):",
        "                return {\"anp_result\": {\"status\": \"error\", \"message\": f\"transformer serverè¿æ¥å¤±è´¥: {str(e)}\"}}",
        "            logger.debug(\"âš ï¸ å›é€€åˆ°æœ¬åœ°å¤„ç†\")",
        ""
      ],
      "function": "process_agent_message",
      "class": "unknown"
    },
    {
      "file": "anp_foundation/anp_user_local_data.py",
      "line": 188,
      "type": "get_global_config",
      "code": "config = get_global_config()",
      "context": [
        "    def __init__(self, user_dir: Optional[str] = None):",
        "        if hasattr(self, '_initialized') and self._initialized:",
        "            return",
        "        config = get_global_config()",
        "        self._user_dir = user_dir or config.anp_sdk.user_did_path",
        "",
        "        # æä¾›å¤šç§ç´¢å¼•æ–¹å¼ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡"
      ],
      "function": "__init__",
      "class": "LocalUserDataManager"
    },
    {
      "file": "anp_foundation/anp_user_local_data.py",
      "line": 703,
      "type": "get_global_config",
      "code": "config=get_global_config()",
      "context": [
        "    if not all(field in user_iput for field in required_fields):",
        "        logger.error(\"ç¼ºå°‘å¿…éœ€çš„å‚æ•°å­—æ®µ\")",
        "        return None",
        "    config=get_global_config()",
        "",
        "    userdid_filepath = config.anp_sdk.user_did_path",
        "    userdid_filepath = UnifiedConfig.resolve_path(userdid_filepath)"
      ],
      "function": "create_did_user",
      "class": "LocalUserDataManager"
    },
    {
      "file": "anp_foundation/anp_user_local_data.py",
      "line": 189,
      "type": "config_access",
      "config_key": "anp_sdk.user_did_path",
      "code": "self._user_dir = user_dir or config.anp_sdk.user_did_path",
      "context": [
        "        if hasattr(self, '_initialized') and self._initialized:",
        "            return",
        "        config = get_global_config()",
        "        self._user_dir = user_dir or config.anp_sdk.user_did_path",
        "",
        "        # æä¾›å¤šç§ç´¢å¼•æ–¹å¼ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡",
        "        self.users_by_did: Dict[str, LocalUserData] = {}"
      ],
      "function": "__init__",
      "class": "LocalUserDataManager"
    },
    {
      "file": "anp_foundation/anp_user_local_data.py",
      "line": 705,
      "type": "config_access",
      "config_key": "anp_sdk.user_did_path",
      "code": "userdid_filepath = config.anp_sdk.user_did_path",
      "context": [
        "        return None",
        "    config=get_global_config()",
        "",
        "    userdid_filepath = config.anp_sdk.user_did_path",
        "    userdid_filepath = UnifiedConfig.resolve_path(userdid_filepath)",
        "",
        ""
      ],
      "function": "create_did_user",
      "class": "LocalUserDataManager"
    },
    {
      "file": "anp_foundation/anp_user_local_data.py",
      "line": 244,
      "type": "config_access",
      "config_key": "anp_sdk.user_did_key_id",
      "code": "key_id = get_global_config().anp_sdk.user_did_key_id  # ä½¿ç”¨é»˜è®¤å€¼ä½œä¸ºåå¤‡",
      "context": [
        "",
        "                if not key_id:",
        "                    logger.warning(f\"æ— æ³•åœ¨ {folder_name} çš„DIDæ–‡æ¡£ä¸­ç¡®å®škey_id\")",
        "                    key_id = get_global_config().anp_sdk.user_did_key_id  # ä½¿ç”¨é»˜è®¤å€¼ä½œä¸ºåå¤‡",
        "",
        "                password_paths = {",
        "                    \"did_private_key_file_path\": os.path.join(user_folder_path, f\"{key_id}_private.pem\"),"
      ],
      "function": "load_all_users",
      "class": "LocalUserDataManager"
    },
    {
      "file": "anp_foundation/anp_user_local_data.py",
      "line": 514,
      "type": "config_access",
      "config_key": "anp_sdk.user_did_key_id",
      "code": "key_id = get_global_config().anp_sdk.user_did_key_id",
      "context": [
        "            # æ„å»ºå¯†é’¥è·¯å¾„",
        "            key_id = self.parse_key_id_from_did_doc(did_doc)",
        "            if not key_id:",
        "                key_id = get_global_config().anp_sdk.user_did_key_id",
        "",
        "            password_paths = {",
        "                \"did_private_key_file_path\": os.path.join(user_folder_path, f\"{key_id}_private.pem\"),"
      ],
      "function": "load_single_user",
      "class": "LocalUserDataManager"
    },
    {
      "file": "anp_foundation/anp_user.py",
      "line": 77,
      "type": "get_global_config",
      "code": "config = get_global_config()",
      "context": [
        "            logger.debug(f\"ğŸ†• ç¼“å­˜ANPUserå®ä¾‹ (ç›´æ¥æ„é€ ): {self.id}\")",
        "        else:",
        "            logger.debug(f\"ğŸ”„ ANPUserå®ä¾‹å·²å­˜åœ¨äºç¼“å­˜ä¸­: {self.id}\")",
        "        config = get_global_config()",
        "        self.key_id = config.anp_sdk.user_did_key_id",
        "",
        "        self.did_document_path = self.user_data.did_doc_path"
      ],
      "function": "__init__",
      "class": "ANPUser"
    },
    {
      "file": "anp_foundation/anp_user.py",
      "line": 78,
      "type": "config_access",
      "config_key": "anp_sdk.user_did_key_id",
      "code": "self.key_id = config.anp_sdk.user_did_key_id",
      "context": [
        "        else:",
        "            logger.debug(f\"ğŸ”„ ANPUserå®ä¾‹å·²å­˜åœ¨äºç¼“å­˜ä¸­: {self.id}\")",
        "        config = get_global_config()",
        "        self.key_id = config.anp_sdk.user_did_key_id",
        "",
        "        self.did_document_path = self.user_data.did_doc_path",
        "        self.private_key_path = self.user_data.did_private_key_file_path"
      ],
      "function": "__init__",
      "class": "ANPUser"
    },
    {
      "file": "anp_foundation/did/did_tool.py",
      "line": 69,
      "type": "get_global_config",
      "code": "config = get_global_config()",
      "context": [
        "        # Calculate time difference",
        "        time_diff = abs((current_time - request_time).total_seconds() / 60)",
        "",
        "        config = get_global_config()",
        "        nonce_expire_minutes = config.anp_sdk.nonce_expire_minutes",
        "",
        "        # Verify timestamp is within valid period"
      ],
      "function": "verify_timestamp",
      "class": "AuthenticationContext"
    },
    {
      "file": "anp_foundation/did/did_tool.py",
      "line": 311,
      "type": "get_global_config",
      "code": "config = get_global_config()",
      "context": [
        "    Returns:",
        "        str: Encoded JWT token",
        "    \"\"\"",
        "    config = get_global_config()",
        "    token_expire_time = config.anp_sdk.token_expire_time",
        "",
        "    to_encode = data.copy()"
      ],
      "function": "create_access_token",
      "class": "AuthenticationContext"
    },
    {
      "file": "anp_foundation/did/did_tool.py",
      "line": 70,
      "type": "config_access",
      "config_key": "anp_sdk.nonce_expire_minutes",
      "code": "nonce_expire_minutes = config.anp_sdk.nonce_expire_minutes",
      "context": [
        "        time_diff = abs((current_time - request_time).total_seconds() / 60)",
        "",
        "        config = get_global_config()",
        "        nonce_expire_minutes = config.anp_sdk.nonce_expire_minutes",
        "",
        "        # Verify timestamp is within valid period",
        "        if time_diff > nonce_expire_minutes:"
      ],
      "function": "verify_timestamp",
      "class": "AuthenticationContext"
    },
    {
      "file": "anp_foundation/did/did_tool.py",
      "line": 312,
      "type": "config_access",
      "config_key": "anp_sdk.token_expire_time",
      "code": "token_expire_time = config.anp_sdk.token_expire_time",
      "context": [
        "        str: Encoded JWT token",
        "    \"\"\"",
        "    config = get_global_config()",
        "    token_expire_time = config.anp_sdk.token_expire_time",
        "",
        "    to_encode = data.copy()",
        "    expires = datetime.now(timezone.utc) + (timedelta(minutes=expires_delta) if expires_delta else timedelta(seconds=token_expire_time))"
      ],
      "function": "create_access_token",
      "class": "AuthenticationContext"
    },
    {
      "file": "anp_foundation/did/did_tool.py",
      "line": 322,
      "type": "config_access",
      "config_key": "anp_sdk.jwt_algorithm",
      "code": "jwt_algorithm = config.anp_sdk.jwt_algorithm",
      "context": [
        "        logger.debug(\"Invalid JWT private key object provided\")",
        "        raise HTTPException(status_code=500, detail=\"Internal anp_servicepoint error during token generation\")",
        "",
        "    jwt_algorithm = config.anp_sdk.jwt_algorithm",
        "    # Create the JWT token using RS256 algorithm with private key",
        "    encoded_jwt = jwt.encode(",
        "        to_encode,"
      ],
      "function": "create_access_token",
      "class": "AuthenticationContext"
    },
    {
      "file": "anp_foundation/did/did_format_manager.py",
      "line": 37,
      "type": "get_global_config",
      "code": "self.config = get_global_config()",
      "context": [
        "    ",
        "    def __init__(self):",
        "        \"\"\"åˆå§‹åŒ–DIDæ ¼å¼ç®¡ç†å™¨\"\"\"",
        "        self.config = get_global_config()",
        "        self.domain_manager = get_domain_manager()",
        "        self._format_cache = {}",
        "        "
      ],
      "function": "__init__",
      "class": "DidFormatManager"
    },
    {
      "file": "anp_foundation/did/did_format_manager.py",
      "line": 233,
      "type": "config_access",
      "config_key": "did_config.creatable_user_types",
      "code": "creatable_types = self.config.did_config.creatable_user_types",
      "context": [
        "            bool: æ˜¯å¦å¯ä»¥åˆ›å»º",
        "        \"\"\"",
        "        try:",
        "            creatable_types = self.config.did_config.creatable_user_types",
        "            return user_type in creatable_types",
        "        except AttributeError:",
        "            # é…ç½®ä¸­æ²¡æœ‰ç›¸å…³è®¾ç½®ï¼Œé»˜è®¤åªå…è®¸åˆ›å»ºuserç±»å‹"
      ],
      "function": "can_create_user_type",
      "class": "DidFormatManager"
    },
    {
      "file": "anp_foundation/did/did_format_manager.py",
      "line": 329,
      "type": "config_access",
      "config_key": "did_config.format_template",
      "code": "return self.config.did_config.format_template",
      "context": [
        "    def _get_format_template(self) -> str:",
        "        \"\"\"è·å–DIDæ ¼å¼æ¨¡æ¿\"\"\"",
        "        try:",
        "            return self.config.did_config.format_template",
        "        except AttributeError:",
        "            return \"did:{method}:{host}:{method}:{user_type}:{user_id}\"",
        "    "
      ],
      "function": "_get_format_template",
      "class": "DidFormatManager"
    },
    {
      "file": "anp_foundation/did/did_format_manager.py",
      "line": 336,
      "type": "config_access",
      "config_key": "did_config.method",
      "code": "return self.config.did_config.method",
      "context": [
        "    def _get_method(self) -> str:",
        "        \"\"\"è·å–DIDæ–¹æ³•å\"\"\"",
        "        try:",
        "            return self.config.did_config.method",
        "        except AttributeError:",
        "            return \"wba\"",
        "    "
      ],
      "function": "_get_method",
      "class": "DidFormatManager"
    },
    {
      "file": "anp_foundation/did/did_format_manager.py",
      "line": 360,
      "type": "config_access",
      "config_key": "did_config.user_types",
      "code": "user_types = self.config.did_config.user_types",
      "context": [
        "            List[str]: ç”¨æˆ·ç±»å‹åˆ—è¡¨",
        "        \"\"\"",
        "        try:",
        "            user_types = self.config.did_config.user_types",
        "            if hasattr(user_types, 'user'):",
        "                return [user_types.user, user_types.hostuser, user_types.test]",
        "            elif hasattr(user_types, 'values'):"
      ],
      "function": "get_supported_user_types",
      "class": "DidFormatManager"
    },
    {
      "file": "anp_foundation/did/did_format_manager.py",
      "line": 390,
      "type": "config_access",
      "config_key": "did_config.creatable_user_types",
      "code": "return list(self.config.did_config.creatable_user_types)",
      "context": [
        "            List[str]: å¯åˆ›å»ºçš„ç”¨æˆ·ç±»å‹åˆ—è¡¨",
        "        \"\"\"",
        "        try:",
        "            return list(self.config.did_config.creatable_user_types)",
        "        except AttributeError:",
        "            return [\"user\"]",
        "    "
      ],
      "function": "get_creatable_user_types",
      "class": "DidFormatManager"
    },
    {
      "file": "anp_foundation/config/__init__.py",
      "line": 18,
      "type": "config_access",
      "config_key": "py",
      "code": "- ç»Ÿä¸€é…ç½®ç®¡ç†ï¼ˆunified_config.pyï¼‰",
      "context": [
        "\"\"\"ANP Open SDK é…ç½®æ¨¡å—",
        "",
        "æä¾›ç»Ÿä¸€çš„é…ç½®ç®¡ç†åŠŸèƒ½ï¼Œæ”¯æŒï¼š",
        "- ç»Ÿä¸€é…ç½®ç®¡ç†ï¼ˆunified_config.pyï¼‰",
        "- ç±»å‹æç¤ºå’Œåè®®ï¼ˆconfig_types.pyï¼‰",
        "- å‘åå…¼å®¹çš„åŠ¨æ€é…ç½®ï¼ˆdynamic_config.pyï¼‰",
        ""
      ],
      "function": "unknown",
      "class": "unknown"
    },
    {
      "file": "anp_foundation/config/__init__.py",
      "line": 20,
      "type": "config_access",
      "config_key": "py",
      "code": "- å‘åå…¼å®¹çš„åŠ¨æ€é…ç½®ï¼ˆdynamic_config.pyï¼‰",
      "context": [
        "æä¾›ç»Ÿä¸€çš„é…ç½®ç®¡ç†åŠŸèƒ½ï¼Œæ”¯æŒï¼š",
        "- ç»Ÿä¸€é…ç½®ç®¡ç†ï¼ˆunified_config.pyï¼‰",
        "- ç±»å‹æç¤ºå’Œåè®®ï¼ˆconfig_types.pyï¼‰",
        "- å‘åå…¼å®¹çš„åŠ¨æ€é…ç½®ï¼ˆdynamic_config.pyï¼‰",
        "",
        "\"\"\"",
        ""
      ],
      "function": "unknown",
      "class": "unknown"
    },
    {
      "file": "anp_foundation/config/unified_config.py",
      "line": 246,
      "type": "config_access",
      "config_key": "yaml",
      "code": "return self._app_root / \"unified_config.yaml\"",
      "context": [
        "        if config_file:",
        "            return Path(config_file).resolve()",
        "            # é»˜è®¤é…ç½®æ–‡ä»¶è·¯å¾„åŸºäº app_root",
        "        return self._app_root / \"unified_config.yaml\"",
        "",
        "",
        ""
      ],
      "function": "_resolve_config_file",
      "class": "UnifiedConfig"
    },
    {
      "file": "anp_foundation/config/unified_config.py",
      "line": 306,
      "type": "config_access",
      "config_key": "get",
      "code": "separator = path_config.get('path_separator')",
      "context": [
        "        if path_str.startswith('[') and path_str.endswith(']'):",
        "            path_str = os.environ.get('PATH', '')",
        "        path_config = self._config_data.get('path_config', {})",
        "        separator = path_config.get('path_separator')",
        "        if not separator:",
        "            separator = ';' if os.name == 'nt' else ':'",
        "        paths = []"
      ],
      "function": "_process_path_list",
      "class": "UnifiedConfig"
    },
    {
      "file": "anp_foundation/config/unified_config.py",
      "line": 467,
      "type": "config_access",
      "config_key": "default.yaml",
      "code": "default_config_path = self._app_root / 'unified_config.default.yaml'",
      "context": [
        "        return self._config_data.copy()",
        "",
        "    def _get_default_config(self) -> dict:",
        "        default_config_path = self._app_root / 'unified_config.default.yaml'",
        "        if not default_config_path.exists():",
        "            self.logger.warning(f\"é»˜è®¤é…ç½®æ–‡ä»¶ {default_config_path} ä¸å­˜åœ¨ã€‚å°†ä½¿ç”¨ç©ºé…ç½®ã€‚\")",
        "            return {}"
      ],
      "function": "_get_default_config",
      "class": "UnifiedConfig"
    },
    {
      "file": "anp_foundation/auth/auth_verifier.py",
      "line": 209,
      "type": "get_global_config",
      "code": "config = get_global_config()",
      "context": [
        "                logger.debug(\"Failed to load JWT public key\")",
        "                raise HTTPException(status_code=500, detail=\"Internal anp_servicepoint error during token verification\")",
        "",
        "            config = get_global_config()",
        "            jwt_algorithm = config.anp_sdk.jwt_algorithm",
        "",
        "            # Decode and verify the token using the public key"
      ],
      "function": "_verify_bearer_token",
      "class": "unknown"
    },
    {
      "file": "anp_foundation/auth/auth_verifier.py",
      "line": 261,
      "type": "get_global_config",
      "code": "config = get_global_config()",
      "context": [
        "    \"\"\"",
        "    from datetime import datetime, timezone, timedelta",
        "    try:",
        "        config = get_global_config()",
        "        nonce_expire_minutes = config.anp_sdk.nonce_expire_minutes",
        "    except Exception:",
        "        nonce_expire_minutes = 5"
      ],
      "function": "is_valid_server_nonce",
      "class": "unknown"
    },
    {
      "file": "anp_foundation/auth/auth_verifier.py",
      "line": 283,
      "type": "get_global_config",
      "code": "config = get_global_config()",
      "context": [
        "    logger.debug(f\"Nonce accepted and marked as used: {nonce}\")",
        "    return True",
        "async def _generate_wba_auth_response\t(did, is_two_way_auth, resp_did):",
        "    config = get_global_config()",
        "    expiration_time = config.anp_sdk.token_expire_time",
        "   # ç”Ÿæˆè®¿é—®ä»¤ç‰Œ",
        "    resp_did_agent = ANPUser.from_did(resp_did)"
      ],
      "function": "_generate_wba_auth_response",
      "class": "unknown"
    },
    {
      "file": "anp_foundation/auth/auth_verifier.py",
      "line": 210,
      "type": "config_access",
      "config_key": "anp_sdk.jwt_algorithm",
      "code": "jwt_algorithm = config.anp_sdk.jwt_algorithm",
      "context": [
        "                raise HTTPException(status_code=500, detail=\"Internal anp_servicepoint error during token verification\")",
        "",
        "            config = get_global_config()",
        "            jwt_algorithm = config.anp_sdk.jwt_algorithm",
        "",
        "            # Decode and verify the token using the public key",
        "            payload = jwt.decode("
      ],
      "function": "_verify_bearer_token",
      "class": "unknown"
    },
    {
      "file": "anp_foundation/auth/auth_verifier.py",
      "line": 262,
      "type": "config_access",
      "config_key": "anp_sdk.nonce_expire_minutes",
      "code": "nonce_expire_minutes = config.anp_sdk.nonce_expire_minutes",
      "context": [
        "    from datetime import datetime, timezone, timedelta",
        "    try:",
        "        config = get_global_config()",
        "        nonce_expire_minutes = config.anp_sdk.nonce_expire_minutes",
        "    except Exception:",
        "        nonce_expire_minutes = 5",
        ""
      ],
      "function": "is_valid_server_nonce",
      "class": "unknown"
    },
    {
      "file": "anp_foundation/auth/auth_verifier.py",
      "line": 284,
      "type": "config_access",
      "config_key": "anp_sdk.token_expire_time",
      "code": "expiration_time = config.anp_sdk.token_expire_time",
      "context": [
        "    return True",
        "async def _generate_wba_auth_response\t(did, is_two_way_auth, resp_did):",
        "    config = get_global_config()",
        "    expiration_time = config.anp_sdk.token_expire_time",
        "   # ç”Ÿæˆè®¿é—®ä»¤ç‰Œ",
        "    resp_did_agent = ANPUser.from_did(resp_did)",
        "    access_token = create_access_token("
      ],
      "function": "_generate_wba_auth_response",
      "class": "unknown"
    },
    {
      "file": "anp_foundation/utils/log_base.py",
      "line": 55,
      "type": "get_global_config",
      "code": "config = get_global_config()",
      "context": [
        "    Args:",
        "        config: ä¸€ä¸ªç¬¦åˆ UnifiedConfigProtocol åè®®çš„å®Œæ•´é…ç½®å¯¹è±¡ã€‚",
        "    \"\"\"",
        "    config = get_global_config()",
        "",
        "    global _is_logging_configured",
        "    if _is_logging_configured:"
      ],
      "function": "setup_logging",
      "class": "ColoredFormatter"
    },
    {
      "file": "anp_foundation/utils/log_base.py",
      "line": 72,
      "type": "config_access",
      "config_key": "detail",
      "code": "log_file = getattr(log_config.detail, 'file', None)",
      "context": [
        "    if log_config:",
        "        log_level_str = getattr(log_config, 'log_level', 'INFO').upper()",
        "        if hasattr(log_config, 'detail'):",
        "            log_file = getattr(log_config.detail, 'file', None)",
        "            max_size_mb = getattr(log_config.detail, 'max_size', 10)",
        "",
        "    # å°†å­—ç¬¦ä¸²çº§åˆ«è½¬æ¢ä¸º logging çš„æ•´æ•°çº§åˆ«"
      ],
      "function": "setup_logging",
      "class": "ColoredFormatter"
    },
    {
      "file": "anp_foundation/utils/log_base.py",
      "line": 73,
      "type": "config_access",
      "config_key": "detail",
      "code": "max_size_mb = getattr(log_config.detail, 'max_size', 10)",
      "context": [
        "        log_level_str = getattr(log_config, 'log_level', 'INFO').upper()",
        "        if hasattr(log_config, 'detail'):",
        "            log_file = getattr(log_config.detail, 'file', None)",
        "            max_size_mb = getattr(log_config.detail, 'max_size', 10)",
        "",
        "    # å°†å­—ç¬¦ä¸²çº§åˆ«è½¬æ¢ä¸º logging çš„æ•´æ•°çº§åˆ«",
        "    log_level = getattr(logging, log_level_str, logging.INFO)"
      ],
      "function": "setup_logging",
      "class": "ColoredFormatter"
    },
    {
      "file": "anp_foundation/utils/log_base.py",
      "line": 98,
      "type": "config_access",
      "config_key": "resolve_path",
      "code": "log_file_path = config.resolve_path(log_file)",
      "context": [
        "    if log_file:",
        "        try:",
        "            # ä½¿ç”¨ config å¯¹è±¡çš„æ–¹æ³•æ¥è§£æè·¯å¾„ï¼Œè¿™æ˜¯æœ€å¥å£®çš„æ–¹å¼",
        "            log_file_path = config.resolve_path(log_file)",
        "",
        "            # ç¡®ä¿ç›®å½•å­˜åœ¨ï¼Œä¸å†ä½¿ç”¨ sudo",
        "            log_file_path.parent.mkdir(parents=True, exist_ok=True)"
      ],
      "function": "setup_logging",
      "class": "ColoredFormatter"
    },
    {
      "file": "anp_foundation/domain/domain_manager.py",
      "line": 35,
      "type": "get_global_config",
      "code": "self.config = get_global_config()",
      "context": [
        "    ",
        "    def __init__(self):",
        "        \"\"\"åˆå§‹åŒ–åŸŸåç®¡ç†å™¨\"\"\"",
        "        self.config = get_global_config()",
        "        self._supported_domains = None",
        "        self._domain_config_cache = {}",
        "        "
      ],
      "function": "__init__",
      "class": "DomainManager"
    },
    {
      "file": "anp_foundation/domain/domain_manager.py",
      "line": 44,
      "type": "config_access",
      "config_key": "did_config.hosts",
      "code": "hosts_config = self.config.did_config.hosts",
      "context": [
        "        \"\"\"è·å–æ”¯æŒçš„åŸŸååˆ—è¡¨\"\"\"",
        "        if self._supported_domains is None:",
        "            try:",
        "                hosts_config = self.config.did_config.hosts",
        "                ",
        "                # å¦‚æœæ˜¯ConfigNodeå¯¹è±¡ï¼Œéœ€è¦è½¬æ¢ä¸ºå­—å…¸",
        "                if hasattr(hosts_config, '_data'):"
      ],
      "function": "supported_domains",
      "class": "DomainManager"
    },
    {
      "file": "anp_foundation/domain/domain_manager.py",
      "line": 48,
      "type": "config_access",
      "config_key": "_data",
      "code": "self._supported_domains = hosts_config._data",
      "context": [
        "                ",
        "                # å¦‚æœæ˜¯ConfigNodeå¯¹è±¡ï¼Œéœ€è¦è½¬æ¢ä¸ºå­—å…¸",
        "                if hasattr(hosts_config, '_data'):",
        "                    self._supported_domains = hosts_config._data",
        "                elif hasattr(hosts_config, '__dict__'):",
        "                    # å°è¯•ä»å¯¹è±¡å±æ€§æ„å»ºå­—å…¸",
        "                    self._supported_domains = {}"
      ],
      "function": "supported_domains",
      "class": "DomainManager"
    },
    {
      "file": "anp_foundation/domain/domain_manager.py",
      "line": 66,
      "type": "config_access",
      "config_key": "hosts",
      "code": "logger.warning(\"é…ç½®ä¸­æœªæ‰¾åˆ°did_config.hostsï¼Œä½¿ç”¨é»˜è®¤åŸŸåé…ç½®\")",
      "context": [
        "                    ",
        "            except AttributeError:",
        "                # å¦‚æœé…ç½®ä¸­æ²¡æœ‰did_configï¼Œä½¿ç”¨é»˜è®¤å€¼",
        "                logger.warning(\"é…ç½®ä¸­æœªæ‰¾åˆ°did_config.hostsï¼Œä½¿ç”¨é»˜è®¤åŸŸåé…ç½®\")",
        "                self._supported_domains = {",
        "                    \"localhost\": 9527,",
        "                    \"user.localhost\": 9527,"
      ],
      "function": "supported_domains",
      "class": "DomainManager"
    },
    {
      "file": "anp_foundation/domain/domain_manager.py",
      "line": 121,
      "type": "config_access",
      "config_key": "did_config.parsing.default_host",
      "code": "default_host = self.config.did_config.parsing.default_host",
      "context": [
        "    def _get_default_host_port(self) -> Tuple[str, int]:",
        "        \"\"\"è·å–é»˜è®¤çš„ä¸»æœºå’Œç«¯å£\"\"\"",
        "        try:",
        "            default_host = self.config.did_config.parsing.default_host",
        "            default_port = self.config.did_config.parsing.default_port",
        "            return default_host, default_port",
        "        except AttributeError:"
      ],
      "function": "_get_default_host_port",
      "class": "DomainManager"
    },
    {
      "file": "anp_foundation/domain/domain_manager.py",
      "line": 122,
      "type": "config_access",
      "config_key": "did_config.parsing.default_port",
      "code": "default_port = self.config.did_config.parsing.default_port",
      "context": [
        "        \"\"\"è·å–é»˜è®¤çš„ä¸»æœºå’Œç«¯å£\"\"\"",
        "        try:",
        "            default_host = self.config.did_config.parsing.default_host",
        "            default_port = self.config.did_config.parsing.default_port",
        "            return default_host, default_port",
        "        except AttributeError:",
        "            return \"localhost\", 9527"
      ],
      "function": "_get_default_host_port",
      "class": "DomainManager"
    },
    {
      "file": "anp_foundation/domain/domain_manager.py",
      "line": 211,
      "type": "config_access",
      "config_key": "unified_config",
      "code": "from anp_foundation.config.unified_config import UnifiedConfig",
      "context": [
        "        \"\"\"",
        "        try:",
        "            # ä½¿ç”¨UnifiedConfigçš„æ ‡å‡†è·¯å¾„è§£æåŠŸèƒ½",
        "            from anp_foundation.config.unified_config import UnifiedConfig",
        "            ",
        "            # æ„å»ºç›¸å¯¹äºAPP_ROOTçš„æ•°æ®è·¯å¾„",
        "            data_path_template = f\"{{APP_ROOT}}/{self.get_data_path_for_domain(domain, port)}\""
      ],
      "function": "get_all_data_paths",
      "class": "DomainManager"
    },
    {
      "file": "anp_foundation/domain/domain_manager.py",
      "line": 321,
      "type": "config_access",
      "config_key": "did_config.insecure_patterns",
      "code": "insecure_patterns = self.config.did_config.insecure_patterns",
      "context": [
        "        ",
        "        # æ£€æŸ¥æ˜¯å¦æ˜¯ä¸å®‰å…¨çš„åŸŸåï¼ˆä»…åœ¨éç”Ÿäº§ç¯å¢ƒå…è®¸ï¼‰",
        "        try:",
        "            insecure_patterns = self.config.did_config.insecure_patterns",
        "            allow_insecure = self.config.did_config.parsing.allow_insecure",
        "            ",
        "            if not allow_insecure:"
      ],
      "function": "validate_domain_access",
      "class": "DomainManager"
    },
    {
      "file": "anp_foundation/domain/domain_manager.py",
      "line": 322,
      "type": "config_access",
      "config_key": "did_config.parsing.allow_insecure",
      "code": "allow_insecure = self.config.did_config.parsing.allow_insecure",
      "context": [
        "        # æ£€æŸ¥æ˜¯å¦æ˜¯ä¸å®‰å…¨çš„åŸŸåï¼ˆä»…åœ¨éç”Ÿäº§ç¯å¢ƒå…è®¸ï¼‰",
        "        try:",
        "            insecure_patterns = self.config.did_config.insecure_patterns",
        "            allow_insecure = self.config.did_config.parsing.allow_insecure",
        "            ",
        "            if not allow_insecure:",
        "                for pattern in insecure_patterns:"
      ],
      "function": "validate_domain_access",
      "class": "DomainManager"
    }
  ],
  "dependency_injection_analysis": {
    "total_usages": 80,
    "files_count": 15,
    "config_keys_used": [
      "_data",
      "anp_sdk",
      "anp_sdk.debug_mode",
      "anp_sdk.host",
      "anp_sdk.jwt_algorithm",
      "anp_sdk.nonce_expire_minutes",
      "anp_sdk.port",
      "anp_sdk.token_expire_time",
      "anp_sdk.user_did_key_id",
      "anp_sdk.user_did_path",
      "anp_sdk.user_hosted_path",
      "auth_middleware.exempt_paths",
      "default.yaml",
      "detail",
      "did_config.creatable_user_types",
      "did_config.format_template",
      "did_config.hosts",
      "did_config.insecure_patterns",
      "did_config.method",
      "did_config.parsing.allow_insecure",
      "did_config.parsing.default_host",
      "did_config.parsing.default_port",
      "did_config.user_types",
      "get",
      "hosts",
      "py",
      "resolve_path",
      "unified_config",
      "yaml"
    ],
    "injection_opportunities": [
      {
        "file": "anp_runtime/agent_manager.py",
        "type": "class_constructor_injection",
        "classes": [
          "AgentRouter",
          "LocalAgentManager"
        ],
        "usage_count": 8,
        "suggestion": "ä¸º AgentRouter, LocalAgentManager ç±»æ·»åŠ  config å‚æ•°åˆ°æ„é€ å‡½æ•°"
      },
      {
        "file": "anp_runtime/agent_manager.py",
        "type": "function_parameter_injection",
        "functions": [
          "load_agent_from_module",
          "_resolve_shared_did",
          "_register_message_handlers_new"
        ],
        "usage_count": 8,
        "suggestion": "ä¸º load_agent_from_module, _resolve_shared_did, _register_message_handlers_new å‡½æ•°æ·»åŠ  config å‚æ•°"
      },
      {
        "file": "anp_server/run_lite_server_template.py",
        "type": "class_constructor_injection",
        "classes": [
          "ANP_Server"
        ],
        "usage_count": 5,
        "suggestion": "ä¸º ANP_Server ç±»æ·»åŠ  config å‚æ•°åˆ°æ„é€ å‡½æ•°"
      },
      {
        "file": "anp_server/run_lite_server_template.py",
        "type": "function_parameter_injection",
        "functions": [
          "__init__",
          "start_server"
        ],
        "usage_count": 5,
        "suggestion": "ä¸º __init__, start_server å‡½æ•°æ·»åŠ  config å‚æ•°"
      },
      {
        "file": "anp_server/baseline/anp_server_baseline.py",
        "type": "class_constructor_injection",
        "classes": [
          "ANP_Server"
        ],
        "usage_count": 5,
        "suggestion": "ä¸º ANP_Server ç±»æ·»åŠ  config å‚æ•°åˆ°æ„é€ å‡½æ•°"
      },
      {
        "file": "anp_server/baseline/anp_server_baseline.py",
        "type": "function_parameter_injection",
        "functions": [
          "__init__",
          "start_server"
        ],
        "usage_count": 5,
        "suggestion": "ä¸º __init__, start_server å‡½æ•°æ·»åŠ  config å‚æ•°"
      },
      {
        "file": "anp_servicepoint/extend_service_implementation/did_host/did_host_manager.py",
        "type": "class_constructor_injection",
        "classes": [
          "DIDHostManager"
        ],
        "usage_count": 2,
        "suggestion": "ä¸º DIDHostManager ç±»æ·»åŠ  config å‚æ•°åˆ°æ„é€ å‡½æ•°"
      },
      {
        "file": "anp_servicepoint/extend_service_implementation/did_host/did_host_manager.py",
        "type": "function_parameter_injection",
        "functions": [
          "__init__"
        ],
        "usage_count": 2,
        "suggestion": "ä¸º __init__ å‡½æ•°æ·»åŠ  config å‚æ•°"
      },
      {
        "file": "anp_servicepoint/core_service_handler/agent_service_handler.py",
        "type": "function_parameter_injection",
        "functions": [
          "process_group_request",
          "process_agent_message",
          "process_agent_api_request"
        ],
        "usage_count": 15,
        "suggestion": "ä¸º process_group_request, process_agent_message, process_agent_api_request å‡½æ•°æ·»åŠ  config å‚æ•°"
      },
      {
        "file": "anp_foundation/anp_user_local_data.py",
        "type": "class_constructor_injection",
        "classes": [
          "LocalUserDataManager"
        ],
        "usage_count": 6,
        "suggestion": "ä¸º LocalUserDataManager ç±»æ·»åŠ  config å‚æ•°åˆ°æ„é€ å‡½æ•°"
      },
      {
        "file": "anp_foundation/anp_user_local_data.py",
        "type": "function_parameter_injection",
        "functions": [
          "load_all_users",
          "load_single_user",
          "create_did_user",
          "__init__"
        ],
        "usage_count": 6,
        "suggestion": "ä¸º load_all_users, load_single_user, create_did_user, __init__ å‡½æ•°æ·»åŠ  config å‚æ•°"
      },
      {
        "file": "anp_foundation/anp_user.py",
        "type": "class_constructor_injection",
        "classes": [
          "ANPUser"
        ],
        "usage_count": 2,
        "suggestion": "ä¸º ANPUser ç±»æ·»åŠ  config å‚æ•°åˆ°æ„é€ å‡½æ•°"
      },
      {
        "file": "anp_foundation/anp_user.py",
        "type": "function_parameter_injection",
        "functions": [
          "__init__"
        ],
        "usage_count": 2,
        "suggestion": "ä¸º __init__ å‡½æ•°æ·»åŠ  config å‚æ•°"
      },
      {
        "file": "anp_foundation/did/did_tool.py",
        "type": "class_constructor_injection",
        "classes": [
          "AuthenticationContext"
        ],
        "usage_count": 5,
        "suggestion": "ä¸º AuthenticationContext ç±»æ·»åŠ  config å‚æ•°åˆ°æ„é€ å‡½æ•°"
      },
      {
        "file": "anp_foundation/did/did_tool.py",
        "type": "function_parameter_injection",
        "functions": [
          "create_access_token",
          "verify_timestamp"
        ],
        "usage_count": 5,
        "suggestion": "ä¸º create_access_token, verify_timestamp å‡½æ•°æ·»åŠ  config å‚æ•°"
      },
      {
        "file": "anp_foundation/did/did_format_manager.py",
        "type": "class_constructor_injection",
        "classes": [
          "DidFormatManager"
        ],
        "usage_count": 6,
        "suggestion": "ä¸º DidFormatManager ç±»æ·»åŠ  config å‚æ•°åˆ°æ„é€ å‡½æ•°"
      },
      {
        "file": "anp_foundation/did/did_format_manager.py",
        "type": "function_parameter_injection",
        "functions": [
          "_get_format_template",
          "get_creatable_user_types",
          "_get_method",
          "__init__",
          "get_supported_user_types",
          "can_create_user_type"
        ],
        "usage_count": 6,
        "suggestion": "ä¸º _get_format_template, get_creatable_user_types, _get_method, __init__, get_supported_user_types, can_create_user_type å‡½æ•°æ·»åŠ  config å‚æ•°"
      },
      {
        "file": "anp_foundation/config/unified_config.py",
        "type": "class_constructor_injection",
        "classes": [
          "UnifiedConfig"
        ],
        "usage_count": 3,
        "suggestion": "ä¸º UnifiedConfig ç±»æ·»åŠ  config å‚æ•°åˆ°æ„é€ å‡½æ•°"
      },
      {
        "file": "anp_foundation/config/unified_config.py",
        "type": "function_parameter_injection",
        "functions": [
          "_process_path_list",
          "_get_default_config",
          "_resolve_config_file"
        ],
        "usage_count": 3,
        "suggestion": "ä¸º _process_path_list, _get_default_config, _resolve_config_file å‡½æ•°æ·»åŠ  config å‚æ•°"
      },
      {
        "file": "anp_foundation/auth/auth_verifier.py",
        "type": "function_parameter_injection",
        "functions": [
          "_verify_bearer_token",
          "is_valid_server_nonce",
          "_generate_wba_auth_response"
        ],
        "usage_count": 6,
        "suggestion": "ä¸º _verify_bearer_token, is_valid_server_nonce, _generate_wba_auth_response å‡½æ•°æ·»åŠ  config å‚æ•°"
      },
      {
        "file": "anp_foundation/utils/log_base.py",
        "type": "class_constructor_injection",
        "classes": [
          "ColoredFormatter"
        ],
        "usage_count": 4,
        "suggestion": "ä¸º ColoredFormatter ç±»æ·»åŠ  config å‚æ•°åˆ°æ„é€ å‡½æ•°"
      },
      {
        "file": "anp_foundation/utils/log_base.py",
        "type": "function_parameter_injection",
        "functions": [
          "setup_logging"
        ],
        "usage_count": 4,
        "suggestion": "ä¸º setup_logging å‡½æ•°æ·»åŠ  config å‚æ•°"
      },
      {
        "file": "anp_foundation/domain/domain_manager.py",
        "type": "class_constructor_injection",
        "classes": [
          "DomainManager"
        ],
        "usage_count": 9,
        "suggestion": "ä¸º DomainManager ç±»æ·»åŠ  config å‚æ•°åˆ°æ„é€ å‡½æ•°"
      },
      {
        "file": "anp_foundation/domain/domain_manager.py",
        "type": "function_parameter_injection",
        "functions": [
          "get_all_data_paths",
          "validate_domain_access",
          "_get_default_host_port",
          "__init__",
          "supported_domains"
        ],
        "usage_count": 9,
        "suggestion": "ä¸º get_all_data_paths, validate_domain_access, _get_default_host_port, __init__, supported_domains å‡½æ•°æ·»åŠ  config å‚æ•°"
      }
    ],
    "refactor_suggestions": []
  },
  "config_usage_patterns": {
    "used_sections": {
      "anp_sdk": 